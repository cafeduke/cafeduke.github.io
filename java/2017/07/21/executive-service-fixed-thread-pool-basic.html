<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <!-- Meta data -->
    <meta charset="utf-8">
<meta name="viewport" content="initial-scale=1, shrink-to-fit=no, width=device-width">
<meta http-equiv="x-ua-compatible" content="ie=edge">

    <!-- Window title -->
    <title>Executor Service - Fixed Thread Pool Basic</title>

    <!-- CSS -->
    <!-- Material fonts from 'https://fonts.google.com' -->
<link href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,500,500i,700,700i" rel="stylesheet">
<link href="https://fonts.googleapis.com/css?family=Roboto+Mono:300,300i,400,400i,500,500i,700,700i" rel="stylesheet">
<link href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,500,500i,700,700i" rel="stylesheet"> 
<link href="https://fonts.googleapis.com/css?family=Vollkorn:300,300i,400,400i,500,500i,700,700i" rel="stylesheet"> 

<!-- Material Icon -->
<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

<!-- Font Awesome Icon -->
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.13/css/all.css" integrity="sha384-DNOHZ68U8hZfKXOrtjWvjxusGo9WQnrNx2sqG0tfsghAvtVlRW3tvkXWZh58N9jp" crossorigin="anonymous">

<!-- Add Material CSS. Replace Bootstrap CSS -->
<link href="/assets/daemonite-material/css/material.min.css" rel="stylesheet">

<!-- Material Color Palette - CSS Classes -->
<link href="/assets/material-design-color-palette/css/material-design-color-palette.css" rel="stylesheet">

<!-- CafeDuke CSS - Project specific Classes  -->
<link href="/assets/css/main.css" rel="stylesheet" type="text/css">

<!-- CafeDuke Syntax CSS - Code syntax highlight -->
<link href="/assets/css/duke-dark.css" rel="stylesheet" type="text/css">


</head>
<body>

    <!-- Navigation bar -->
    <nav class="navbar navbar-expand-lg navbar-dark mdc-bg-purple-900">
    
    

    <!-- Collapse Icon -->
    <a id="sidebar-toggle" class="navbar-brand text-white" href="">
        <i class="material-icons md-24">menu</i>
    </a>

    <!-- NavBar Heading -->
    <a class="navbar-brand text-white" href="/">Cafe Duke Notes</a>

    <!-- Collapse button -->
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">

        <!-- Links -->
        <ul class="navbar-nav mr-auto">


        </ul>
        <!-- Links -->

        <!-- Search form
        <form class="form-inline">
            <input class="form-control mr-sm-2" type="text" placeholder="Search" aria-label="Search">
        </form>
         -->

    </div>
    <!-- Collapsible content -->

</nav>


    <!-- Row: Content -->
    <div class="container-fluid m-0 p-0 h-100">

        <div class="row h-100 no-gutters">

            <!-- Column: Sidebar -->
            <div id="sidebar">

    <ul class="nav flex-column">

        <li class="nav-item">
            <a class="nav-link d-flex align-items-center" href="/">
                <i class="fas fa-home fa-lg"></i>
                <span class="nav-link-text">Home</span>
            </a>
        </li>

        <li class="nav-item">
            <a class="nav-link d-flex align-items-center" href="/java">
                <i class="fab fa-java fa-2x"></i>
                <span class="nav-link-text">Java</span>
            </a>
        </li>

        <li class="nav-item">
            <a class="nav-link d-flex align-items-center" href="/git">
                <i class="fab fa-git fa-lg"></i>
                <span class="nav-link-text">Git</span>
            </a>
        </li>

        <li class="nav-item">
            <a class="nav-link d-flex align-items-center" href="/cloud">
                <i class="material-icons md-24">cloud</i>
                <span class="nav-link-text">Cloud</span>
            </a>
        </li>

        <li class="nav-item">
            <a class="nav-link d-flex align-items-center" data-toggle="collapse" data-target="#child-dl" href="#">
                <i class="fas fa-cogs fa-lg"></i>
                <span class="nav-link-text">Deep Learning</span>
            </a>
            <div id="child-dl" class="collapse">
                <ul class="nav flex-column">
                    <li class="nav-item">
                        <a class="nav-link d-flex align-items-center" href="/deeplearning">
                            <span class="nav-link-text">Core</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link d-flex align-items-center" href="/deeplearning/strategy">
                            <span class="nav-link-text">Strategy</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link d-flex align-items-center" href="/deeplearning/cnn">
                            <span class="nav-link-text">CNN</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link d-flex align-items-center" href="/deeplearning/rnn">
                            <span class="nav-link-text">RNN</span>
                        </a>
                    </li>
                </ul>
            </div>
        </li>

        <li class="nav-item">
            <a class="nav-link d-flex align-items-center" href="/django">
                <i class="fa fa-lg">dj</i>
                <span class="nav-link-text">Django</span>
            </a>
        </li>

        <li class="nav-item">
            <a class="nav-link d-flex align-items-center" href="/spring">
                <i class="fas fa-leaf fa-lg"></i>
                <span class="nav-link-text">Spring</span>
            </a>
        </li>

    </ul>
</div>


            <!-- Column: Content Wrapper -->
            <div class="col">
                <div id="content" class="w-100">
<div id="post-wrap" class="row d-flex justify-content-center">

    <div class="card col-md-10 col-xs-12 mt-5">

        <div class="card-header">
            <h1 class="post-title">Executor Service - Fixed Thread Pool Basic</h1>
            <h6 class="card-subtitle post-meta"> 
                Friday, 21 July 2017
                
            </h6>            
        </div>

        <hr class="post-ruler">

        <div class="card-body">
            <nav>
  <h4>Table of Contents</h4>
<ol id="markdown-toc">
  <li>
<a href="#executor-service---basics" id="markdown-toc-executor-service---basics">Executor service - Basics</a>    <ol>
      <li><a href="#factorialtask---a-callable" id="markdown-toc-factorialtask---a-callable">FactorialTask - A Callable<integer></integer></a></li>
      <li><a href="#invoke-all-callable" id="markdown-toc-invoke-all-callable">Invoke all Callable </a></li>
      <li><a href="#reuse-executor-service" id="markdown-toc-reuse-executor-service">Reuse Executor Service</a></li>
      <li><a href="#shutdown-executor-service" id="markdown-toc-shutdown-executor-service">Shutdown Executor Service</a></li>
      <li><a href="#putting-it-all-together" id="markdown-toc-putting-it-all-together">Putting it all together</a></li>
    </ol>
  </li>
</ol>

</nav>

<h1 id="executor-service---basics">Executor service - Basics</h1>

<p>In this article, we shall see a simple example of using <a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/ExecutorService.html">ExecutorService</a>. Here, we use a <a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/Executors.html#newFixedThreadPool-int-">FixedThreadPool</a> executor service. An <a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/ExecutorService.html">ExecutorService</a> provides a mechanism that creates and manages multiple threads within a thread pool. Here, the intricacies of thread management are abstracted, simplifying executing tasks in parallel, thus increasing efficiency.</p>

<p>We take a look at an example where we need to find the factorial of random numbers stored in an array.</p>

<ul>
  <li>This requires creation of a <a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/Callable.html">Callable</a> task - In this case, a factorial task finds factorial of a given number.</li>
  <li>We create a list of <a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/Callable.html">Callable</a> tasks, each to find factorial of a different number.</li>
  <li>We shall invoke the entire list of <a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/Callable.html">Callable</a> tasks.</li>
  <li>A <a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/Executors.html#newFixedThreadPool-int-">FixedThreadPool</a> executor service shall dedicate the specified fixed number of threads to work on the <a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/Callable.html">Callable</a> task in parallel</li>
  <li>
    <p>Each thread from the executor service shall pick a task from the list and work on it (invoke call method). Once done, the thread shall pick the next pending task until all the task in the list are complete.</p>
  </li>
  <li>Since multiple threads are working in parallel the list of tasks will be complete in lesser time.</li>
</ul>

<h2 id="factorialtask---a-callable">FactorialTask - A Callable<integer></integer>
</h2>

<p>The <code class="language-plaintext highlighter-rouge">call</code> method of the <code class="language-plaintext highlighter-rouge">FactorialTask</code> shall calculate the factorial of the given number and return it.</p>

<p>Factorial of a number <code class="language-plaintext highlighter-rouge">n</code> can be recursively defined as <code class="language-plaintext highlighter-rouge">f(n) = n * f(n-1)</code>. At any given stage, it is possible that some other thread has already calculated <code class="language-plaintext highlighter-rouge">f(n-1)</code>. In this case, we just fetch the value and multiply by <code class="language-plaintext highlighter-rouge">n</code>. We then add <code class="language-plaintext highlighter-rouge">(n, f(n))</code> to a map mapNumFactorial so that other threads can take advantage of this calculation.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">static</span> <span class="kd">class</span> <span class="nc">FactorialTask</span> <span class="kd">implements</span> <span class="nc">Callable</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">&gt;</span>  
<span class="o">{</span>  
   <span class="kd">private</span> <span class="kt">int</span> <span class="n">n</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="o">;</span>  
     
   <span class="kd">private</span> <span class="kd">static</span> <span class="nc">Map</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">,</span><span class="nc">Integer</span><span class="err">\</span><span class="o">&gt;</span> <span class="n">mapNumFactorial</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ConcurrentHashMap</span><span class="o">&lt;&gt;</span> <span class="o">();</span>  
     
   <span class="kd">public</span> <span class="nf">FactorialTask</span> <span class="o">(</span><span class="kt">int</span> <span class="n">n</span><span class="o">)</span>  
   <span class="o">{</span>  
      <span class="k">this</span><span class="o">.</span><span class="na">n</span> <span class="o">=</span> <span class="n">n</span><span class="o">;</span>  
   <span class="o">}</span>  
  
   <span class="nd">@Override</span>  
   <span class="kd">public</span> <span class="nc">Integer</span> <span class="nf">call</span> <span class="o">()</span> <span class="kd">throws</span> <span class="nc">Exception</span>  
   <span class="o">{</span>  
      <span class="k">if</span> <span class="o">(</span><span class="n">n</span> <span class="o">==</span> <span class="mi">0</span> <span class="o">||</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">1</span><span class="o">)</span>  
         <span class="k">return</span> <span class="mi">1</span><span class="o">;</span>  
        
      <span class="kt">int</span> <span class="n">prod</span> <span class="o">=</span> <span class="mi">1</span><span class="o">;</span>  
      <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">n</span><span class="o">;</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="o">;</span> <span class="o">--</span><span class="n">i</span><span class="o">)</span>  
      <span class="o">{</span>  
         <span class="k">if</span> <span class="o">(</span><span class="n">mapNumFactorial</span><span class="o">.</span><span class="na">containsKey</span><span class="o">(</span><span class="n">i</span><span class="o">))</span>  
         <span class="o">{</span>  
            <span class="nc">Util</span><span class="o">.</span><span class="na">threadLog</span><span class="o">(</span><span class="nc">String</span><span class="o">.</span><span class="na">format</span><span class="o">(</span><span class="s">"[n=%3d] Found %d! "</span><span class="o">,</span> <span class="n">n</span><span class="o">,</span> <span class="n">i</span><span class="o">));</span>  
            <span class="n">prod</span> <span class="o">=</span> <span class="n">prod</span> <span class="o">*</span> <span class="n">mapNumFactorial</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">i</span><span class="o">);</span>  
            <span class="k">break</span><span class="o">;</span>  
         <span class="o">}</span>  
         <span class="n">prod</span> <span class="o">=</span> <span class="n">prod</span> <span class="o">*</span> <span class="n">i</span><span class="o">;</span>  
         <span class="nc">Util</span><span class="o">.</span><span class="na">sleepInMilli</span><span class="o">(</span><span class="mi">100</span><span class="o">);</span>  
      <span class="o">}</span>  
        
      <span class="nc">Util</span><span class="o">.</span><span class="na">threadLog</span><span class="o">(</span><span class="nc">String</span><span class="o">.</span><span class="na">format</span><span class="o">(</span><span class="s">"[n=%3d] Adding %d! "</span><span class="o">,</span> <span class="n">n</span><span class="o">,</span> <span class="n">n</span><span class="o">));</span>  
      <span class="n">mapNumFactorial</span><span class="o">.</span><span class="na">putIfAbsent</span><span class="o">(</span><span class="n">n</span><span class="o">,</span> <span class="n">prod</span><span class="o">);</span>        
      <span class="k">return</span> <span class="n">prod</span><span class="o">;</span>  
   <span class="o">}</span>        
<span class="o">}</span>  

</code></pre></div></div>

<h2 id="invoke-all-callable">Invoke all Callable </h2>

<p>We create a list of <a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/Callable.html">Callable</a> and invoke them all using the <a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/ExecutorService.html#invokeAll-java.util.Collection-">invokeAll</a> call. The <a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/ExecutorService.html#invokeAll-java.util.Collection-">invokeAll</a> invokes all the <a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/Callable.html">Callable</a>, but waits for them to complete (either succeed for fail with an exception, either way complete). It returns a list of <a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/Future.html">Future</a> objects which are used to <a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/Future.html#get--">get</a> the result.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kt">void</span> <span class="nf">demoFixedPoolExec</span> <span class="o">()</span> <span class="kd">throws</span> <span class="nc">InterruptedException</span><span class="o">,</span> <span class="nc">ExecutionException</span>  
<span class="o">{</span>  
   <span class="nc">Util</span><span class="o">.</span><span class="na">threadLog</span><span class="o">(</span><span class="s">"Started Fixed Thread Pool Demo"</span><span class="o">);</span>  
   <span class="nc">ExecutorService</span> <span class="n">execService</span> <span class="o">=</span> <span class="nc">Executors</span><span class="o">.</span><span class="na">newFixedThreadPool</span><span class="o">(</span><span class="n">poolSize</span><span class="o">);</span>  
     
 <span class="cm">/* Iteration 1 */</span>  
     
   <span class="c1">// Need to find factorial of the following numbers   </span>
   <span class="kt">int</span> <span class="n">num</span><span class="o">[]</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">int</span> <span class="o">[]</span> <span class="o">{</span> <span class="mi">10</span><span class="o">,</span> <span class="mi">3</span><span class="o">,</span> <span class="mi">8</span><span class="o">,</span> <span class="mi">5</span><span class="o">,</span> <span class="mi">12</span><span class="o">};</span>  
     
   <span class="c1">// A list of Callable tasks  </span>
   <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Callable</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">&gt;</span><span class="err">\</span><span class="o">&gt;</span> <span class="n">listTask</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ArrayList</span><span class="o">&lt;</span><span class="nc">Callable</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">&gt;</span><span class="err">\</span><span class="o">&gt;</span> <span class="o">();</span>  
     
   <span class="nc">Util</span><span class="o">.</span><span class="na">printHeading</span><span class="o">(</span><span class="s">"Iteration 1 - "</span> <span class="err">\</span><span class="o">+</span> <span class="nc">Arrays</span><span class="o">.</span><span class="na">toString</span><span class="o">(</span><span class="n">num</span><span class="o">));</span>  
  
   <span class="c1">// Each Callable task shall find factorial of a random number from 'num' array.  </span>
   <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">num</span><span class="o">.</span><span class="na">length</span><span class="o">;</span> <span class="o">++</span><span class="n">i</span><span class="o">)</span>  
      <span class="n">listTask</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="nc">FactorialTask</span><span class="o">(</span><span class="n">num</span><span class="o">[</span><span class="n">i</span><span class="o">]));</span>  
  
   <span class="c1">// Invoke all the tasks and wait for it to complete  </span>
   <span class="c1">// Note: Unlike submit the invokeAll call is blocking - Waits for all parallel tasks to complete.   </span>
   <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Future</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">&gt;</span><span class="err">\</span><span class="o">&gt;</span> <span class="n">listResult</span> <span class="o">=</span> <span class="n">execService</span><span class="o">.</span><span class="na">invokeAll</span><span class="o">(</span><span class="n">listTask</span><span class="o">);</span>  
     
   <span class="nc">Util</span><span class="o">.</span><span class="na">printSubHeading</span><span class="o">(</span><span class="s">"Result"</span><span class="o">);</span>  
   <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">num</span><span class="o">.</span><span class="na">length</span><span class="o">;</span> <span class="o">++</span><span class="n">i</span><span class="o">)</span>  
      <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="nc">String</span><span class="o">.</span><span class="na">format</span><span class="o">(</span><span class="s">"%d! = %d"</span><span class="o">,</span> <span class="n">num</span><span class="o">[</span><span class="n">i</span><span class="o">],</span> <span class="n">listResult</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">i</span><span class="o">).</span><span class="na">get</span><span class="o">()));</span>  
<span class="o">}</span>  

</code></pre></div></div>

<p><a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/ExecutorService.html">ExecutorService</a>’s <a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/ExecutorService.html#invokeAll-java.util.Collection-">invokeAll</a> call is blocking where as <a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/ExecutorService.html#submit-java.util.concurrent.Callable-">submit</a> is non-blocking.</p>

<p>Had we used the <a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/ExecutorService.html#submit-java.util.concurrent.Callable-">submit</a> call of <a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/ExecutorService.html">ExecutorService</a> (rather than <a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/ExecutorService.html#invokeAll-java.util.Collection-">invokeAll</a>), the call would immediately return a <a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/Future.html">Future</a>object without waiting for the operation to complete. This is useful if we would rather do something else until the results are available. We can even check if the result is available using the <a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/Future.html#isDone--">isDone</a> method. Hence, a reference to a <a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/Future.html">Future</a> object can be used to obtain the result sometime later (in the future). At present, the object may not even hold the result.</p>

<h2 id="reuse-executor-service">Reuse Executor Service</h2>

<p>An executor service can be reused to invoke another list of <a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/Callable.html">Callable</a>s as follows.</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kt">void</span> <span class="nf">demoFixedPoolExec</span> <span class="o">()</span> <span class="kd">throws</span> <span class="nc">InterruptedException</span><span class="o">,</span> <span class="nc">ExecutionException</span>  
<span class="o">{</span>  
   <span class="nc">Util</span><span class="o">.</span><span class="na">threadLog</span><span class="o">(</span><span class="s">"Started Fixed Thread Pool Demo"</span><span class="o">);</span>  
  
   <span class="o">...</span>  
   <span class="o">...</span>  
  
   <span class="cm">/* Iteration 2 */</span>   
  
   <span class="n">listTask</span><span class="o">.</span><span class="na">clear</span><span class="o">();</span>  
   <span class="n">num</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">int</span> <span class="o">[]</span> <span class="o">{</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">11</span><span class="o">,</span> <span class="mi">7</span><span class="o">};</span>        
  
   <span class="nc">Util</span><span class="o">.</span><span class="na">printHeading</span><span class="o">(</span><span class="s">"Iteration 2 - "</span> <span class="err">\</span><span class="o">+</span> <span class="nc">Arrays</span><span class="o">.</span><span class="na">toString</span><span class="o">(</span><span class="n">num</span><span class="o">));</span>  
  
   <span class="c1">// Each Callable task shall find factorial of a random number from 'num' array.  </span>
   <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">num</span><span class="o">.</span><span class="na">length</span><span class="o">;</span> <span class="o">++</span><span class="n">i</span><span class="o">)</span>  
      <span class="n">listTask</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="nc">FactorialTask</span><span class="o">(</span><span class="n">num</span><span class="o">[</span><span class="n">i</span><span class="o">]));</span>  
  
   <span class="n">listResult</span> <span class="o">=</span> <span class="n">execService</span><span class="o">.</span><span class="na">invokeAll</span><span class="o">(</span><span class="n">listTask</span><span class="o">);</span>  
  
   <span class="nc">Util</span><span class="o">.</span><span class="na">printSubHeading</span><span class="o">(</span><span class="s">"Result"</span><span class="o">);</span>  
   <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">num</span><span class="o">.</span><span class="na">length</span><span class="o">;</span> <span class="o">++</span><span class="n">i</span><span class="o">)</span>  
      <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="nc">String</span><span class="o">.</span><span class="na">format</span><span class="o">(</span><span class="s">"%d! = %d"</span><span class="o">,</span> <span class="n">num</span><span class="o">[</span><span class="n">i</span><span class="o">],</span> <span class="n">listResult</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">i</span><span class="o">).</span><span class="na">get</span><span class="o">()));</span>  
<span class="o">}</span>
</code></pre></div></div>

<h2 id="shutdown-executor-service">Shutdown Executor Service</h2>

<p>Shutdown an executor service to prevent accepting new submissions.  Call <a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/ExecutorService.html#awaitTermination-long-java.util.concurrent.TimeUnit-">awaitTermination</a> to wait for the currently executing tasks to complete.</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kt">void</span> <span class="nf">demoFixedPoolExec</span> <span class="o">()</span> <span class="kd">throws</span> <span class="nc">InterruptedException</span><span class="o">,</span> <span class="nc">ExecutionException</span>  
<span class="o">{</span>  
   <span class="nc">Util</span><span class="o">.</span><span class="na">threadLog</span><span class="o">(</span><span class="s">"Started Fixed Thread Pool Demo"</span><span class="o">);</span>  
  
   <span class="o">...</span>  
   <span class="o">...</span>  
  
   <span class="c1">// Shutdown executor service  </span>
   <span class="n">execService</span><span class="o">.</span><span class="na">shutdown</span><span class="o">();</span>  
  
<span class="o">}</span>  
  

</code></pre></div></div>

<h2 id="putting-it-all-together">Putting it all together</h2>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">ExecutorService_FixedThreadPool_Basic</span>  
<span class="o">{</span>  
   <span class="kd">private</span> <span class="kt">int</span> <span class="n">poolSize</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="o">;</span>  
     
   <span class="kd">public</span> <span class="nf">ExecutorService_FixedThreadPool_Basic</span> <span class="o">(</span><span class="kt">int</span> <span class="n">poolSize</span><span class="o">)</span>  
   <span class="o">{</span>  
      <span class="k">this</span><span class="o">.</span><span class="na">poolSize</span> <span class="o">=</span> <span class="n">poolSize</span><span class="o">;</span>  
   <span class="o">}</span>     
     
   <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span> <span class="o">(</span><span class="nc">String</span> <span class="n">arg</span><span class="o">[])</span> <span class="kd">throws</span> <span class="nc">Exception</span>  
   <span class="o">{</span>  
      <span class="k">new</span> <span class="nf">ExecutorService_FixedThreadPool_Basic</span><span class="o">(</span><span class="mi">10</span><span class="o">).</span><span class="na">demoFixedPoolExec</span><span class="o">();</span>  
   <span class="o">}</span>  
     
   <span class="kd">public</span> <span class="kt">void</span> <span class="nf">demoFixedPoolExec</span> <span class="o">()</span> <span class="kd">throws</span> <span class="nc">InterruptedException</span><span class="o">,</span> <span class="nc">ExecutionException</span>  
   <span class="o">{</span>  
      <span class="nc">Util</span><span class="o">.</span><span class="na">threadLog</span><span class="o">(</span><span class="s">"Started Fixed Thread Pool Demo"</span><span class="o">);</span>  
      <span class="nc">ExecutorService</span> <span class="n">execService</span> <span class="o">=</span> <span class="nc">Executors</span><span class="o">.</span><span class="na">newFixedThreadPool</span><span class="o">(</span><span class="n">poolSize</span><span class="o">);</span>  
  
      <span class="o">...</span>  
      <span class="o">...</span>  
        
      <span class="cm">/* Iteration 1 */</span>  
        
      <span class="o">...</span>  
      <span class="o">...</span>  
  
      <span class="cm">/* Iteration 2 */</span>  
        
      <span class="o">...</span>  
      <span class="o">...</span>       
        
      <span class="c1">// Shutdown executor service  </span>
      <span class="n">execService</span><span class="o">.</span><span class="na">shutdown</span><span class="o">();</span>  
      <span class="nc">Util</span><span class="o">.</span><span class="na">threadLog</span><span class="o">(</span><span class="s">"Finished Fixed Thread Pool Demo"</span><span class="o">);</span>  
   <span class="o">}</span>  
     
   <span class="kd">static</span> <span class="kd">class</span> <span class="nc">FactorialTask</span> <span class="kd">implements</span> <span class="nc">Callable</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">&gt;</span>  
   <span class="o">{</span>  
      <span class="o">...</span>  
      <span class="o">...</span>  
   <span class="o">}</span>  
<span class="o">}</span>  

</code></pre></div></div>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">Output</span> <span class="o">|</span> <span class="n">grep</span> <span class="err">'</span><span class="nc">DirTask</span><span class="err">'</span><span class="o">:</span>  
<span class="o">[</span><span class="nc">Thu</span><span class="o">,</span> <span class="mi">17</span><span class="o">-</span><span class="nc">Nov</span><span class="o">-</span><span class="mi">2016</span> <span class="mi">12</span><span class="o">:</span><span class="mo">01</span><span class="o">:</span><span class="mf">34.724</span> <span class="no">IST</span><span class="o">]</span> <span class="o">[</span><span class="nc">Thread</span><span class="o">=</span><span class="n">main</span><span class="o">]</span> <span class="nc">Started</span> <span class="nc">Fixed</span> <span class="nc">Thread</span> <span class="nc">Pool</span> <span class="nc">Demo</span>  
  
<span class="o">------------------------------------------------------------</span>  
              <span class="nc">Iteration</span> <span class="mi">1</span> <span class="o">-</span> <span class="o">[</span><span class="mi">10</span><span class="o">,</span> <span class="mi">3</span><span class="o">,</span> <span class="mi">8</span><span class="o">,</span> <span class="mi">5</span><span class="o">,</span> <span class="mi">12</span><span class="o">]</span>  
<span class="o">------------------------------------------------------------</span>  
<span class="o">[</span><span class="nc">Thu</span><span class="o">,</span> <span class="mi">17</span><span class="o">-</span><span class="nc">Nov</span><span class="o">-</span><span class="mi">2016</span> <span class="mi">12</span><span class="o">:</span><span class="mo">01</span><span class="o">:</span><span class="mf">34.989</span> <span class="no">IST</span><span class="o">]</span> <span class="o">[</span><span class="nc">Thread</span><span class="o">=</span><span class="n">pool</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="n">thread</span><span class="o">-</span><span class="mi">2</span><span class="o">]</span> <span class="o">[</span><span class="n">n</span><span class="o">=</span>  <span class="mi">3</span><span class="o">]</span> <span class="nc">Adding</span> <span class="mi">3</span><span class="o">!</span>   
<span class="o">[</span><span class="nc">Thu</span><span class="o">,</span> <span class="mi">17</span><span class="o">-</span><span class="nc">Nov</span><span class="o">-</span><span class="mi">2016</span> <span class="mi">12</span><span class="o">:</span><span class="mo">01</span><span class="o">:</span><span class="mf">34.989</span> <span class="no">IST</span><span class="o">]</span> <span class="o">[</span><span class="nc">Thread</span><span class="o">=</span><span class="n">pool</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="n">thread</span><span class="o">-</span><span class="mi">4</span><span class="o">]</span> <span class="o">[</span><span class="n">n</span><span class="o">=</span>  <span class="mi">5</span><span class="o">]</span> <span class="nc">Found</span> <span class="mi">3</span><span class="o">!</span>   
<span class="o">[</span><span class="nc">Thu</span><span class="o">,</span> <span class="mi">17</span><span class="o">-</span><span class="nc">Nov</span><span class="o">-</span><span class="mi">2016</span> <span class="mi">12</span><span class="o">:</span><span class="mo">01</span><span class="o">:</span><span class="mf">34.989</span> <span class="no">IST</span><span class="o">]</span> <span class="o">[</span><span class="nc">Thread</span><span class="o">=</span><span class="n">pool</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="n">thread</span><span class="o">-</span><span class="mi">4</span><span class="o">]</span> <span class="o">[</span><span class="n">n</span><span class="o">=</span>  <span class="mi">5</span><span class="o">]</span> <span class="nc">Adding</span> <span class="mi">5</span><span class="o">!</span>   
<span class="o">[</span><span class="nc">Thu</span><span class="o">,</span> <span class="mi">17</span><span class="o">-</span><span class="nc">Nov</span><span class="o">-</span><span class="mi">2016</span> <span class="mi">12</span><span class="o">:</span><span class="mo">01</span><span class="o">:</span><span class="mf">35.083</span> <span class="no">IST</span><span class="o">]</span> <span class="o">[</span><span class="nc">Thread</span><span class="o">=</span><span class="n">pool</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="n">thread</span><span class="o">-</span><span class="mi">3</span><span class="o">]</span> <span class="o">[</span><span class="n">n</span><span class="o">=</span>  <span class="mi">8</span><span class="o">]</span> <span class="nc">Found</span> <span class="mi">5</span><span class="o">!</span>   
<span class="o">[</span><span class="nc">Thu</span><span class="o">,</span> <span class="mi">17</span><span class="o">-</span><span class="nc">Nov</span><span class="o">-</span><span class="mi">2016</span> <span class="mi">12</span><span class="o">:</span><span class="mo">01</span><span class="o">:</span><span class="mf">35.083</span> <span class="no">IST</span><span class="o">]</span> <span class="o">[</span><span class="nc">Thread</span><span class="o">=</span><span class="n">pool</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="n">thread</span><span class="o">-</span><span class="mi">3</span><span class="o">]</span> <span class="o">[</span><span class="n">n</span><span class="o">=</span>  <span class="mi">8</span><span class="o">]</span> <span class="nc">Adding</span> <span class="mi">8</span><span class="o">!</span>   
<span class="o">[</span><span class="nc">Thu</span><span class="o">,</span> <span class="mi">17</span><span class="o">-</span><span class="nc">Nov</span><span class="o">-</span><span class="mi">2016</span> <span class="mi">12</span><span class="o">:</span><span class="mo">01</span><span class="o">:</span><span class="mf">35.192</span> <span class="no">IST</span><span class="o">]</span> <span class="o">[</span><span class="nc">Thread</span><span class="o">=</span><span class="n">pool</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="n">thread</span><span class="o">-</span><span class="mi">5</span><span class="o">]</span> <span class="o">[</span><span class="n">n</span><span class="o">=</span> <span class="mi">12</span><span class="o">]</span> <span class="nc">Found</span> <span class="mi">8</span><span class="o">!</span>   
<span class="o">[</span><span class="nc">Thu</span><span class="o">,</span> <span class="mi">17</span><span class="o">-</span><span class="nc">Nov</span><span class="o">-</span><span class="mi">2016</span> <span class="mi">12</span><span class="o">:</span><span class="mo">01</span><span class="o">:</span><span class="mf">35.192</span> <span class="no">IST</span><span class="o">]</span> <span class="o">[</span><span class="nc">Thread</span><span class="o">=</span><span class="n">pool</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="n">thread</span><span class="o">-</span><span class="mi">5</span><span class="o">]</span> <span class="o">[</span><span class="n">n</span><span class="o">=</span> <span class="mi">12</span><span class="o">]</span> <span class="nc">Adding</span> <span class="mi">12</span><span class="o">!</span>   
<span class="o">[</span><span class="nc">Thu</span><span class="o">,</span> <span class="mi">17</span><span class="o">-</span><span class="nc">Nov</span><span class="o">-</span><span class="mi">2016</span> <span class="mi">12</span><span class="o">:</span><span class="mo">01</span><span class="o">:</span><span class="mf">35.301</span> <span class="no">IST</span><span class="o">]</span> <span class="o">[</span><span class="nc">Thread</span><span class="o">=</span><span class="n">pool</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="n">thread</span><span class="o">-</span><span class="mi">1</span><span class="o">]</span> <span class="o">[</span><span class="n">n</span><span class="o">=</span> <span class="mi">10</span><span class="o">]</span> <span class="nc">Found</span> <span class="mi">5</span><span class="o">!</span>   
<span class="o">[</span><span class="nc">Thu</span><span class="o">,</span> <span class="mi">17</span><span class="o">-</span><span class="nc">Nov</span><span class="o">-</span><span class="mi">2016</span> <span class="mi">12</span><span class="o">:</span><span class="mo">01</span><span class="o">:</span><span class="mf">35.301</span> <span class="no">IST</span><span class="o">]</span> <span class="o">[</span><span class="nc">Thread</span><span class="o">=</span><span class="n">pool</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="n">thread</span><span class="o">-</span><span class="mi">1</span><span class="o">]</span> <span class="o">[</span><span class="n">n</span><span class="o">=</span> <span class="mi">10</span><span class="o">]</span> <span class="nc">Adding</span> <span class="mi">10</span><span class="o">!</span>   
  
<span class="nc">Result</span>  
<span class="o">------------------------------------------------------------</span>  
<span class="mi">10</span><span class="o">!</span> <span class="o">=</span> <span class="mi">3628800</span>  
<span class="mi">3</span><span class="o">!</span> <span class="o">=</span> <span class="mi">6</span>  
<span class="mi">8</span><span class="o">!</span> <span class="o">=</span> <span class="mi">40320</span>  
<span class="mi">5</span><span class="o">!</span> <span class="o">=</span> <span class="mi">120</span>  
<span class="mi">12</span><span class="o">!</span> <span class="o">=</span> <span class="mi">479001600</span>  
  
<span class="o">------------------------------------------------------------</span>  
                  <span class="nc">Iteration</span> <span class="mi">2</span> <span class="o">-</span> <span class="o">[</span><span class="mi">2</span><span class="o">,</span> <span class="mi">11</span><span class="o">,</span> <span class="mi">7</span><span class="o">]</span>  
<span class="o">------------------------------------------------------------</span>  
<span class="o">[</span><span class="nc">Thu</span><span class="o">,</span> <span class="mi">17</span><span class="o">-</span><span class="nc">Nov</span><span class="o">-</span><span class="mi">2016</span> <span class="mi">12</span><span class="o">:</span><span class="mo">01</span><span class="o">:</span><span class="mf">35.410</span> <span class="no">IST</span><span class="o">]</span> <span class="o">[</span><span class="nc">Thread</span><span class="o">=</span><span class="n">pool</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="n">thread</span><span class="o">-</span><span class="mi">7</span><span class="o">]</span> <span class="o">[</span><span class="n">n</span><span class="o">=</span> <span class="mi">11</span><span class="o">]</span> <span class="nc">Found</span> <span class="mi">10</span><span class="o">!</span>   
<span class="o">[</span><span class="nc">Thu</span><span class="o">,</span> <span class="mi">17</span><span class="o">-</span><span class="nc">Nov</span><span class="o">-</span><span class="mi">2016</span> <span class="mi">12</span><span class="o">:</span><span class="mo">01</span><span class="o">:</span><span class="mf">35.410</span> <span class="no">IST</span><span class="o">]</span> <span class="o">[</span><span class="nc">Thread</span><span class="o">=</span><span class="n">pool</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="n">thread</span><span class="o">-</span><span class="mi">7</span><span class="o">]</span> <span class="o">[</span><span class="n">n</span><span class="o">=</span> <span class="mi">11</span><span class="o">]</span> <span class="nc">Adding</span> <span class="mi">11</span><span class="o">!</span>   
<span class="o">[</span><span class="nc">Thu</span><span class="o">,</span> <span class="mi">17</span><span class="o">-</span><span class="nc">Nov</span><span class="o">-</span><span class="mi">2016</span> <span class="mi">12</span><span class="o">:</span><span class="mo">01</span><span class="o">:</span><span class="mf">35.410</span> <span class="no">IST</span><span class="o">]</span> <span class="o">[</span><span class="nc">Thread</span><span class="o">=</span><span class="n">pool</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="n">thread</span><span class="o">-</span><span class="mi">6</span><span class="o">]</span> <span class="o">[</span><span class="n">n</span><span class="o">=</span>  <span class="mi">2</span><span class="o">]</span> <span class="nc">Adding</span> <span class="mi">2</span><span class="o">!</span>   
<span class="o">[</span><span class="nc">Thu</span><span class="o">,</span> <span class="mi">17</span><span class="o">-</span><span class="nc">Nov</span><span class="o">-</span><span class="mi">2016</span> <span class="mi">12</span><span class="o">:</span><span class="mo">01</span><span class="o">:</span><span class="mf">35.519</span> <span class="no">IST</span><span class="o">]</span> <span class="o">[</span><span class="nc">Thread</span><span class="o">=</span><span class="n">pool</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="n">thread</span><span class="o">-</span><span class="mi">8</span><span class="o">]</span> <span class="o">[</span><span class="n">n</span><span class="o">=</span>  <span class="mi">7</span><span class="o">]</span> <span class="nc">Found</span> <span class="mi">5</span><span class="o">!</span>   
<span class="o">[</span><span class="nc">Thu</span><span class="o">,</span> <span class="mi">17</span><span class="o">-</span><span class="nc">Nov</span><span class="o">-</span><span class="mi">2016</span> <span class="mi">12</span><span class="o">:</span><span class="mo">01</span><span class="o">:</span><span class="mf">35.519</span> <span class="no">IST</span><span class="o">]</span> <span class="o">[</span><span class="nc">Thread</span><span class="o">=</span><span class="n">pool</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="n">thread</span><span class="o">-</span><span class="mi">8</span><span class="o">]</span> <span class="o">[</span><span class="n">n</span><span class="o">=</span>  <span class="mi">7</span><span class="o">]</span> <span class="nc">Adding</span> <span class="mi">7</span><span class="o">!</span>   
  
<span class="nc">Result</span>  
<span class="o">------------------------------------------------------------</span>  
<span class="mi">2</span><span class="o">!</span> <span class="o">=</span> <span class="mi">2</span>  
<span class="mi">11</span><span class="o">!</span> <span class="o">=</span> <span class="mi">39916800</span>  
<span class="mi">7</span><span class="o">!</span> <span class="o">=</span> <span class="mi">5040</span>  
<span class="o">[</span><span class="nc">Thu</span><span class="o">,</span> <span class="mi">17</span><span class="o">-</span><span class="nc">Nov</span><span class="o">-</span><span class="mi">2016</span> <span class="mi">12</span><span class="o">:</span><span class="mo">01</span><span class="o">:</span><span class="mf">35.519</span> <span class="no">IST</span><span class="o">]</span> <span class="o">[</span><span class="nc">Thread</span><span class="o">=</span><span class="n">main</span><span class="o">]</span> <span class="nc">Finished</span> <span class="nc">Fixed</span> <span class="nc">Thread</span> <span class="nc">Pool</span> <span class="nc">Demo</span>  
  

</code></pre></div></div>

        </div>

        <div class="card-footer">
            
        </div>

    </div>

</div>
</div>
                <!-- <div id="footer" class="w-100"><div class="footer">
    <div class="footer-col footer-col-1">
    <ul class="contact-list">
      <li>
        <span class="site-author">
           
             Raghunandan.Seshadri
           
        </span>
      </li>

      
      <li><a href="mailto:raghubs81@gmail.com">raghubs81@gmail.com</a></li>
      

      
      <li>
        <a href="https://github.com/cafeduke"><span class="icon icon--github"><svg viewBox="0 0 16 16" width="16px" height="16px"><path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/></svg>
</span><span class="username">cafeduke</span></a>

      </li>
      

    </ul>
    </div>

    <div class="footer-col footer-col-2">
     <ul class="contact-list">
        
           <li>Duke notes. Happy learning!</li>
        
     </ul>
    </div>
</div></div> -->
            </div>
        </div>
    </div>

    <!-- JS -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
<script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"></script>

<!-- Popper -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"></script>

<!-- Bootstrap -->
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>

<!-- Material JavaScript on top of Bootstrap JavaScript -->
<script src="/assets/daemonite-material/js/material.min.js"></script>

<!-- Include and configure MathJax -->
<script type="text/x-mathjax-config">
   MathJax.Hub.Config({
      jax: ["input/AsciiMath", "input/TeX", "input/MathML", "output/HTML-CSS"],
      asciimath2jax: {
         delimiters: [['`','`'], ['$$','$$'], ['$','$']]
      },
      "HTML-CSS": {
         preferredFont:"TeX", availableFonts:["STIX","TeX"]
      }
   });
</script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js"></script>

<script src="/assets/js/mermaid.min.js"></script>

<!-- Google analytics -->


<!-- Sidebar -->
<script src="/assets/js/sidebar.js"></script>



   </body>

</html>
